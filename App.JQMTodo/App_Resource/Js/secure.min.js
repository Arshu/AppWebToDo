var nextRequestId=0;var jsonUserHandler="/Handler/JsonUser.ashx";var jsonUserSecureHandler="/Handler/JsonUserSecure.ashx";function loadLoginInfo(a,d){var c="{";c+="}";var b={id:++nextRequestId,method:"GetLoginUser",params:c};asyncJsonRequest(jsonUserSecureHandler,b,a,function(f){var i=false;if(f.hasOwnProperty("Result")===true){var e=f.Result;if(e.hasOwnProperty("data")===true){var g=e.data;if(typeof(d)==="function"){d(g)}}if(e.hasOwnProperty("error")===true){var h=e.error;showError(h,a)}}})}function loadSelectOption(e,f,b,d,i,c){var a=true;if(a==true){var h="{";h+='"pageNo" : 1';h+=', "itemsPerPage" : 100';h+="}";var g={id:++nextRequestId,method:f,params:h};asyncJsonRequest(e,g,d,function(m){var p=false;if(m.hasOwnProperty("Result")===true){var n=m.Result;if(n.hasOwnProperty("error")===true){var l=n.error;showError(l,d)}else{if(n.hasOwnProperty("html")===true){var j=document.getElementById(b);if(j){var k="#"+b;$(k).html(n.html);j.selectedIndex=i;$(k).selectmenu("refresh");if(typeof(c)==="function"){c()}}}else{if(n.hasOwnProperty("data")===true){var j=document.getElementById(b);if(j){var q=n.data;j.options.length=0;for(var o=0;o<q.length;o++){var s=q[o].Key;var r=q[o].Value;if(r.hasOwnProperty("OptionName")){var t=r.OptionName;j.options[j.options.length]=new Option(t,s)}}if(i==999){j.selectedIndex=j.options.length-1}else{j.selectedIndex=i}var k="#"+b;$(k).selectmenu("refresh");if(typeof(c)==="function"){c()}}}}}}})}}function loadULHtml(e,f,h,d,b,c){var a=true;if(a==true){var i="{";i+='"pageNo" : '+b;i+=', "itemsPerPage" : '+c;i+="}";var g={id:++nextRequestId,method:f,params:i};asyncJsonRequest(e,g,d,function(l){var o=false;if(l.hasOwnProperty("Result")===true){var k=l.Result;if(k.hasOwnProperty("error")===true){var n=k.error;showError(n,d)}else{if(k.hasOwnProperty("html")===true){var j=document.getElementById(h);if(j){var m="#"+h;$(m).show();$(m).html(k.html);$(m).listview("refresh")}}}}})}}function fillRolesSelectTag(b,c,a){loadSelectOption(jsonUserSecureHandler,"GetRoleOptionList",b,c,a)}function fillRoleUsersUvTag(c,b,a,d){loadULHtml(jsonUserSecureHandler,"GetRoleUserListHtml",c,b,a,d)}function isAuthenticated(e,b,a,g){var d=true;if(d==true){var f="{";f+="}";var c={id:++nextRequestId,method:"IsAuthenticated",params:f};asyncJsonRequest(jsonUserHandler,c,b,function(i){var l=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){if(typeof(a)==="function"){a()}else{window.location.replace(e);if(b.length>0){var k=h.message;showSuccess(k,b)}}}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,b);if(typeof(g)==="function"){g(j)}}}}})}}function fillUserId(e,a){var c=true;if(c==true){var d="{";d+="}";var b={id:++nextRequestId,method:"GetLoginUser",params:d};asyncJsonRequest(jsonUserSecureHandler,b,a,function(g){var j=false;if(g.hasOwnProperty("Result")===true){var f=g.Result;if(f.hasOwnProperty("data")===true){var l=document.getElementById(e);if(l){var k=f.data;l.value=k}}if(f.hasOwnProperty("message")===true){if(a.length>0){var i=f.message;showSuccess(i,a)}}else{if(f.hasOwnProperty("error")===true){var h=f.error;showError(h,a)}}}})}}function delete_cookie(a){document.cookie=a+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/"}function logOffUser(b,a,f){var d=true;if(d==true){var e="{";e+="}";var c={id:++nextRequestId,method:"LogOffUser",params:e};asyncJsonRequest(jsonUserHandler,c,b,function(h){var k=false;if(h.hasOwnProperty("Result")===true){var g=h.Result;if(g.hasOwnProperty("message")===true){if(g.hasOwnProperty("cookie")===true){var l=g.cookie;delete_cookie(l)}if(typeof(a)==="function"){a()}else{var j=g.message;showSuccess(j,b);window.location.replace("/Index.ashx")}}else{if(g.hasOwnProperty("error")===true){var i=g.error;if(typeof(f)==="function"){f(i)}else{showError(i,b);setTimeout(function(){window.location.replace("/Index.ashx")},3000)}}}}})}}function loginUser(h,j,i,d,f,c,b){var a=true;if(a==true){var g="{";g+='"userName" : "'+encodeURIComponent(h)+'"';g+=', "userPassword" : "'+encodeURIComponent(j)+'"';g+=', "rememberMe" : '+i;g+="}";var e={id:++nextRequestId,method:"LoginUser",params:g};asyncJsonRequest(jsonUserHandler,e,d,function(m){var p=false;if(m.hasOwnProperty("Result")===true){var l=m.Result;if(l.hasOwnProperty("message")===true){if(typeof(c)==="function"){c()}else{var o=l.message;showSuccess(o,d);setTimeout(function(){window.location.replace("/Index.ashx")},2000)}}else{if(l.hasOwnProperty("error")===true){var n=l.error;if(typeof(b)==="function"){b(n)}else{showError(n,d)}}}if(l.hasOwnProperty("warn")===true){if(typeof(c)==="function"){c()}else{var k=l.warn;showWarning(k,f)}}}})}}function validateUser(h,i,d,f,c,b){var a=true;if(a==true){var g="{";g+='"userName" : "'+encodeURIComponent(h)+'"';g+=', "userPassword" : "'+encodeURIComponent(i)+'"';g+="}";var e={id:++nextRequestId,method:"ValidateUser",params:g};asyncJsonRequest(jsonUserHandler,e,d,function(l){var o=false;if(l.hasOwnProperty("Result")===true){var k=l.Result;if(k.hasOwnProperty("message")===true){if(typeof(c)==="function"){c()}else{var n=k.message;showSuccess(n,d)}}else{if(k.hasOwnProperty("error")===true){var m=k.error;if(typeof(b)==="function"){b(m)}else{showError(m,d)}}}if(k.hasOwnProperty("warn")===true){var j=k.warn;if(typeof(c)==="function"){c(j)}else{showWarning(j,f)}}}})}}function changePassword(b,f,g,a){var d=true;if(d==true){var e="{";e+=', "userId" : "'+encodeURIComponent(b)+'"';e+=', "oldPassword" : "'+encodeURIComponent(f)+'"';e+=', "newPassword" : "'+encodeURIComponent(g)+'"';e+="}";var c={id:++nextRequestId,method:"ChangePassword",params:e};asyncJsonRequest(jsonUserSecureHandler,c,a,function(i){var l=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){var k=h.message;showSuccess(k,a)}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,a)}}}})}}function registerUser(g,e,i,d,c,b){var a=true;if(a==true){var h="{";h+=', "userId" : "'+encodeURIComponent(g)+'"';h+=', "userEmail" : "'+encodeURIComponent(e)+'"';h+=', "userPassword" : "'+encodeURIComponent(i)+'"';h+="}";var f={id:++nextRequestId,method:"RegisterUser",params:h};asyncJsonRequest(jsonUserHandler,f,d,function(k){var n=false;if(k.hasOwnProperty("Result")===true){var j=k.Result;if(j.hasOwnProperty("message")===true){if(typeof(c)==="function"){c()}else{var m=j.message;showSuccess(m,d)}}else{if(j.hasOwnProperty("error")===true){var l=j.error;if(typeof(b)==="function"){b(l)}else{showError(l,d)}}}}})}}function addUserToRole(c,b,f,a){var e=true;if(e==true){var g="{";g+=', "userId" : "'+encodeURIComponent(c)+'"';g+=', "roleName" : "'+encodeURIComponent(b)+'"';g+=', "isDefault" : '+f;g+="}";var d={id:++nextRequestId,method:"AddUserToRole",params:g};asyncJsonRequest(jsonUserSecureHandler,d,a,function(i){var l=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){var k=h.message;showSuccess(k,a);if(typeof(refreshRoleUsersUvTag)==="function"){refreshRoleUsersUvTag()}}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,a)}}}})}}function removeUserFromRole(c,b,a){var e=true;if(e==true){var f="{";f+=', "userId" : "'+encodeURIComponent(c)+'"';f+=', "roleName" : "'+encodeURIComponent(b)+'"';f+="}";var d={id:++nextRequestId,method:"RemoveUserFromRole",params:f};asyncJsonRequest(jsonUserSecureHandler,d,a,function(h){var k=false;if(h.hasOwnProperty("Result")===true){var g=h.Result;if(g.hasOwnProperty("message")===true){var j=g.message;showSuccess(j,a);if(typeof(refreshRoleUsersUvTag)==="function"){refreshRoleUsersUvTag()}}else{if(g.hasOwnProperty("error")===true){var i=g.error;showError(i,a)}}}})}}function btnLogOffUser(a){var b=document.getElementById(a);if(b){b.innerHTML="";b.className="";logOffUser(a)}}function btnLoginUser(a,g,c,b){var e=document.getElementById(b);var f=document.getElementById(a);var h=document.getElementById(g);var d=document.getElementById(c);if((f)&&(h)&&(d)&&(e)){e.innerHTML="";e.className="";if(f.value.length==0){e.className="error";
e.innerHTML="Please enter User Name";$(e).show()}else{if(h.value.length==0){e.className="error";e.innerHTML="Please enter User Password";$(e).show()}else{if(d.checked==true){loginUser(f.value,h.value,true,b)}else{loginUser(f.value,h.value,false,b)}}}}}function btnChangePassword(j,f,i,e,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var a=document.getElementById(j);var h=document.getElementById(f);var g=document.getElementById(i);var b=document.getElementById(e);if((a)&&(h)&&(g)&&(b)&&(d)){if(a.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(h.value.length==0){d.className="error";d.innerHTML="Please enter Old Password";$(d).show()}else{if(g.value.length==0){d.className="error";d.innerHTML="Please enter New Password";$(d).show()}else{if(b.value.length==0){d.className="error";d.innerHTML="Please enter New Confirm Password";$(d).show()}else{if(g.value!=b.value){d.className="error";d.innerHTML="Please Enter the Password and Confirm Password as the Same";$(d).show()}else{changePassword(a.value,h.value,g.value,c)}}}}}}}function btnRegisterUser(j,i,h,g,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var b=document.getElementById(j);var a=document.getElementById(i);var f=document.getElementById(h);var e=document.getElementById(g);if((b)&&(a)&&(f)&&(e)&&(d)){if(b.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(a.value.length==0){d.className="error";d.innerHTML="Please enter User Email";$(d).show()}else{if(f.value.length==0){d.className="error";d.innerHTML="Please enter User Password";$(d).show()}else{if(e.value.length==0){d.className="error";d.innerHTML="Please enter User Confirm Password";$(d).show()}else{if(f.value!=e.value){d.className="error";d.innerHTML="Please Enter the Password and Confirm Password as the Same";$(d).show()}else{registerUser(b.value,a.value,f.value,c)}}}}}}}function btnAddRemoveUserRole(e,a,f,c){var d=document.getElementById(c);d.innerHTML="";d.className="";var g=document.getElementById(a);var b=document.getElementById(f);if((g)&&(b)&&(d)){if(g.value.length==0){d.className="error";d.innerHTML="Please enter User Id";$(d).show()}else{if(b.value.length==0){d.className="error";d.innerHTML="Please select User Role";$(d).show()}else{if(e===true){addUserToRole(g.value,b.value,false,c)}else{removeUserFromRole(g.value,b.value,c)}}}}};