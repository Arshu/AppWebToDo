var _cache={};_cache.init=function(){if(typeof(this.memory)=="undefined"){this.memory={}}};_cache.set=function(a,b){this.memory[a]=b};_cache.get=function(a){if(typeof(_cache.memory[a])!="undefined"){if(_cache.memory[a]!=null){return _cache.memory[a]}}return false};_cache.clear=function(){this.memory={}};_cache.init();function clearCache(){_cache.clear()}var nextRequestId=0;var jsonDbRequestPath="/Handler/JsonDb.ashx";function haveSQLiteDatabase(f,h,b,c){if(typeof(c)=="undefined"){c=false}var d=f;var a=_cache.get(d);if(a==false){var g="{";g+='"dbName" : "'+f+'"';g+="}";var e={id:++nextRequestId,method:"HaveSQLiteDatabase",params:g};asyncJsonRequest(jsonDbRequestPath,e,h,function(j){var l=false;if(j.hasOwnProperty("Result")===true){var i=j.Result;if(i.hasOwnProperty("message")===true){if(c){_cache.set(d,f)}else{_cache.set(d,null)}if(typeof(b)==="function"){b()}l=true}else{if(i.hasOwnProperty("error")===true){var k=i.error;console.log(k);showError(k,h)}}}else{if(j.hasOwnProperty("Error")===true){var k=j.Error;console.log(k)}}if(l===false){console.log(f+" Database Not Found")}})}else{if(typeof(b)==="function"){b()}}}function doSQLExecute(g,d,e,b,c,a){if(typeof(a)=="undefined"){a=false}var i=g+d+e;var j=_cache.get(i);if(j==false){var h="{";h+='"dbName" : "'+g+'"';h+=', "sqlStatement" : "'+e+'"';h+="}";var f={id:++nextRequestId,method:d,params:h};asyncJsonRequest(jsonDbRequestPath,f,b,function(l){var o=false;var m=false;if(l.hasOwnProperty("Result")===true){var k=l.Result;if(k.hasOwnProperty("data")===true){var p=k.data;if(a){_cache.set(i,p)}else{_cache.set(i,null)}if(typeof(c)==="function"){c(p)}o=true}else{if(k.hasOwnProperty("error")===true){var n=k.error;console.log(n);showError(n,b);m=true}}}else{if(l.hasOwnProperty("Error")===true){var n=l.Error;console.log(n)}}if((o===false)&&(m==false)){console.log("No data found for "+e)}})}else{if(typeof(c)==="function"){c(j)}}}function doSQLSelectPaged(h,f,a,d,c,e,b){if(typeof(b)=="undefined"){b=false}var j=h+"DoSelectPaged"+f+a+d;var k=_cache.get(j);if(k==false){var i="{";i+='"dbName" : "'+h+'"';i+=', "sqlStatement" : "'+f+'"';i+=', "pageNo" : '+a;i+=', "itemsPerPage" : '+d;i+="}";var g={id:++nextRequestId,method:"DoSelectPaged",params:i};asyncJsonRequest(jsonDbRequestPath,g,c,function(m){var p=false;var n=false;if(m.hasOwnProperty("Result")===true){var l=m.Result;if(l.hasOwnProperty("data")===true){var q=l.data;if(b){_cache.set(j,q)}else{_cache.set(j,null)}if(typeof(e)==="function"){e(q)}p=true}else{if(l.hasOwnProperty("error")===true){var o=l.error;console.log(o);showError(o,c);n=true}}}else{if(m.hasOwnProperty("Error")===true){var o=m.Error;console.log(o)}}if((p===false)&&(n==false)){console.log("No data found for "+f)}})}else{if(typeof(e)==="function"){e(k)}}}function doSQLExtractCsv(f,d,h,i,c,b){var a=true;if(a==true){var g="{";g+='"dbName" : "'+f+'"';g+=', "sqlStatement" : "'+d+'"';g+=', "dataFilePath" : "'+h+'"';g+=', "writeHeaderName" : '+i;g+=', "csvFieldDelimiter" : ","';g+="}";var e={id:++nextRequestId,method:"DoExtractCsv",params:g};asyncJsonRequest(jsonDbRequestPath,e,c,function(k){var m=false;if(k.hasOwnProperty("Result")===true){var j=k.Result;if(j.hasOwnProperty("message")===true){if(typeof(b)==="function"){b()}}else{if(j.hasOwnProperty("error")===true){var l=j.error;showError(l,c);console.log(l)}}}else{if(k.hasOwnProperty("Error")===true){var l=k.Error;console.log(l)}}})}}var jsonHtmlRequestPath="/Handler/JsonHtml.ashx";function fillPagedList(i,g,l,a,c,j,h,m,d,b){var e=j;var k="{";k+='"dbName" : "'+i+'"';k+=', "selectStatement" : "'+g+'"';k+=', "dataTemplateName" : "'+l+'"';k+=', "pageId" : "'+e+'"';k+=', "pageNo" : '+a;k+=', "itemsPerPage" : '+c;k+=', "headerTemplateName" : "liItemHeader"';k+=', "footerTemplateName" : "liItemFooter"';k+="}";var f={id:++nextRequestId,method:"GetHtmlPaged",params:k};asyncJsonRequest(jsonHtmlRequestPath,f,d,function(r){if(r.hasOwnProperty("Result")===true){var s=r.Result;var p="#"+j;if(s.hasOwnProperty("html")===true){var t=0;if(s.hasOwnProperty("totalPages")===true){t=s.totalPages}var n=0;if(s.hasOwnProperty("pageNo")===true){n=s.pageNo}var u=s.html;var o="";var v="";if(t>=1){if(s.hasOwnProperty("htmlHeader")===true){o=s.htmlHeader}if(s.hasOwnProperty("htmlFooter")===true){v=s.htmlFooter}}$(p).show();$(p).html(h+o+u+v);$(p).listview("refresh");bindPageLink(i,g,l,n,c,j,h,m,d,b,t);if(typeof(b)==="function"){b()}}else{if(s.hasOwnProperty("error")===true){var q=s.error;showError(q,msgId);console.log(q)}else{if(m){$(p).show();$(p).html(h+m);$(p).listview("refresh")}}}}else{if(r.hasOwnProperty("Error")===true){var q=r.Error;console.log(q)}}})}function bindPageLink(i,f,k,a,c,j,h,l,d,b,g){var e=j;if(a==1){$("#footerPrevItem"+e).attr("disabled","disabled");$("#headerPrevItem"+e).attr("disabled","disabled")}if(a==g){$("#footerNextItem"+e).attr("disabled","disabled");$("#headerNextItem"+e).attr("disabled","disabled")}$("#footerNextItem"+e).click(function(){currentPageNo=a+1;fillPagedList(i,f,k,currentPageNo,c,j,"",l,d)});$("#headerNextItem"+e).click(function(){currentPageNo=a+1;fillPagedList(i,f,k,currentPageNo,c,j,"",l,d)});$("#footerPrevItem"+e).click(function(){currentPageNo=a-1;fillPagedList(i,f,k,currentPageNo,c,j,"",l,d)});$("#headerPrevItem"+e).click(function(){currentPageNo=a-1;fillPagedList(i,f,k,currentPageNo,c,j,"",l,d)})}var jsonFileRequestPath="/Handler/JsonFile.ashx";function haveConfigFile(a,c,d,f,b){if(typeof(b)=="undefined"){b=false}var h=a;var i=_cache.get(h);if(i==false){var g="{";g+='"relativePath" : "'+a+'"';g+="}";var e={id:++nextRequestId,method:"HaveFileData",params:g};asyncJsonRequest(jsonFileRequestPath,e,c,function(k){var m=false;if(k.hasOwnProperty("Result")===true){var j=k.Result;if(j.hasOwnProperty("message")===true){if(b){_cache.set(h,a)}else{_cache.set(h,null)}if(typeof(d)==="function"){d()}}else{if(j.hasOwnProperty("error")===true){var l=j.error;console.log(l);if(typeof(f)==="function"){f(l)}}}}else{if(k.hasOwnProperty("Error")===true){var l=k.Error;console.log(l)}}})}else{if(typeof(d)==="function"){d()}}}function checkConfigData(b,l,a,d,e,f,j,c){if(typeof(c)=="undefined"){c=false}var i=b+l;var k=_cache.get(i);if(k==false){var h="{";h+='"relativePath" : "'+b+'"';h+="}";var g={id:++nextRequestId,method:"GetFileData",params:h};asyncJsonRequest(jsonFileRequestPath,g,d,function(n){var p=false;if(n.hasOwnProperty("Result")===true){var m=n.Result;if(m.hasOwnProperty("data")===true){var q=m.data;if(q.hasOwnProperty(l)===true){if(c){_cache.set(i,q)}else{_cache.set(i,null)}if(q[l]===a){if(typeof(e)==="function"){e()}}else{if(typeof(f)==="function"){f()}}}else{if(typeof(j)==="function"){j()}else{showError("The Config Data ["+l+"] does not exist",d)}}}else{if(m.hasOwnProperty("error")===true){var o=m.error;showError(o,d);console.log(o)}}}else{if(n.hasOwnProperty("Error")===true){var o=n.Error;console.log(o)}}})}else{if(k[l]===a){if(typeof(e)==="function"){e()}}else{if(typeof(f)==="function"){f()}}}}function getConfigData(f,h,b,c){if(typeof(c)=="undefined"){c=false}var d=f;var a=_cache.get(d);if(a==false){var g="{";g+='"relativePath" : "'+f+'"';g+="}";var e={id:++nextRequestId,method:"GetFileData",params:g};asyncJsonRequest(jsonFileRequestPath,e,h,function(j){var l=false;if(j.hasOwnProperty("Result")===true){var i=j.Result;if(i.hasOwnProperty("data")===true){var m=i.data;if(c){_cache.set(d,m)}else{_cache.set(d,null)}if(typeof(b)==="function"){b(m)}}else{if(i.hasOwnProperty("error")===true){var k=i.error;showError(k,h);console.log(k)}}}else{if(j.hasOwnProperty("Error")===true){var k=j.Error;console.log(k)}}})}else{if(typeof(b)==="function"){b(a)}}}function createConfigData(a,j,b,c,d){var k=true;var g="{";if($.isArray(j)){if(j.length===b.length){for(var f=0;f<configName.length;f++){if(g.length>1){g+=","}if(($.type(b)==="number")||($.type(b)==="boolean")){g+='"'+j[f]+'" : '+b[f]}else{g+='"'+j[f]+'" : "'+b[f]+'"'}}}else{showError("Config Name and Value Array Length does not match",c);k=false}}else{if(($.type(b)==="number")||($.type(b)==="boolean")){g+='"'+j+'" : '+b
}else{g+='"'+j+'" : "'+b+'"'}}g+="}";if(k===true){var h="{";h+='"relativePath" : "'+a+'"';h+=', "jsonFileData" : '+g;h+="}";var e={id:++nextRequestId,method:"UpdateFileData",params:h};asyncJsonRequest(jsonFileRequestPath,e,c,function(l){var n=false;if(l.hasOwnProperty("Result")===true){var i=l.Result;if(i.hasOwnProperty("message")===true){if(typeof(d)==="function"){d()}}else{if(i.hasOwnProperty("error")===true){var m=i.error;showError(m,c);console.log(m)}}}else{if(l.hasOwnProperty("Error")===true){var m=l.Error;console.log(m)}}})}}function saveConfigData(a,j,b,c,d){var k=true;var g="{";if($.isArray(j)){if(j.length===b.length){for(var f=0;f<configName.length;f++){if(g.length>1){g+=","}if(($.type(b)==="number")||($.type(b)==="boolean")){g+='"'+j[f]+'" : '+b[f]}else{g+='"'+j[f]+'" : "'+b[f]+'"'}}}else{showError("Config Name and Value Array Length does not match",c);k=false}}else{if(($.type(b)==="number")||($.type(b)==="boolean")){g+='"'+j+'" : '+b}else{g+='"'+j+'" : "'+b+'"'}}g+="}";if(k===true){var h="{";h+='"relativePath" : "'+a+'"';h+=', "jsonFileData" : '+g;h+="}";var e={id:++nextRequestId,method:"UpdateFileData",params:h};asyncJsonRequest(jsonFileRequestPath,e,c,function(l){var n=false;if(l.hasOwnProperty("Result")===true){var i=l.Result;if(i.hasOwnProperty("message")===true){if(typeof(d)==="function"){d()}}else{if(i.hasOwnProperty("error")===true){var m=i.error;showError(m,c);console.log(m)}}}else{if(l.hasOwnProperty("Error")===true){var m=l.Error;console.log(m)}}})}}function setConfigData(d,b,g,a){var f=true;if(f===true){var e="{";e+='"relativePath" : "'+d+'"';e+=', "jsonFileData" : '+b;e+="}";var c={id:++nextRequestId,method:"UpdateFileData",params:e};asyncJsonRequest(jsonFileRequestPath,c,g,function(i){var k=false;if(i.hasOwnProperty("Result")===true){var h=i.Result;if(h.hasOwnProperty("message")===true){if(typeof(a)==="function"){a()}}else{if(h.hasOwnProperty("error")===true){var j=h.error;showError(j,g);console.log(j)}}}else{if(i.hasOwnProperty("Error")===true){var j=i.Error;console.log(j)}}})}}function loadConfig(b,a,c,e){var d=document.getElementById(b);if(d){haveConfigFile(a,msgElmId,function(){getConfigData(a,msgElmId,function(f){if(f.hasOwnProperty(c)===true){var g=f[c];d.value=g;if(typeof(e)==="function"){e()}}else{if(d.value.length>0){var g=parseInt(d.value);saveConfigData(a,c,g,msgElmId,function(){if(typeof(e)==="function"){e()}})}}},false)},function(){if(d.value.length>0){var f=parseInt(d.value);createConfigData(a,c,f,msgElmId,function(){if(typeof(e)==="function"){e()}})}})}}function saveConfigNumber(b,c,a,e,h){var g=document.getElementById(b);if(g){if(g.value.length==0){showError(c,msgElmId)}if(g.value.length>0){var d=g.value;if(isNumber(d)==true){var f=parseInt(d);saveConfigData(a,e,f,msgElmId,function(){if(typeof(h)==="function"){h()}})}else{showError(c,msgElmId)}}}}var jsonMailRequestPath="/Handler/JsonMail.ashx";function sendMail(j,a,i,g,k,d,c,e,b){var h="{";h+='"mailFrom" : "'+j+'"';h+=', "mailTo" : "'+a+'"';h+=', "mailSubject" : "'+i+'"';h+=', "mailTemplate" : "'+g+'"';h+=', "replaceList" : '+k;h+=', "attachList" : '+d;h+=', "mailConfigName" : "'+c+'"';h+="}";var f={id:++nextRequestId,method:"SendMail",params:h};asyncJsonRequest(jsonMailRequestPath,f,e,function(m){var o=false;if(m.hasOwnProperty("Result")===true){var l=m.Result;if(l.hasOwnProperty("message")===true){if(typeof(b)==="function"){b()}}else{if(l.hasOwnProperty("error")===true){var n=l.error;showError(n,e);console.log(n)}}}else{if(m.hasOwnProperty("Error")===true){var n=m.Error;console.log(n)}}})}var jsonHashHandler="/Handler/JsonHash.ashx";function hashRegister(f,e,m,k,i,g,l,c,b){var a=true;var j="{}";if(a==true){var h="{";h+='"hashType" : "PurchaserRegister"';h+=', "hash" : "'+encodeURIComponent(f)+'"';h+=', "hashFrom" : "'+encodeURIComponent(e)+'"';h+=', "hashTo" : "'+encodeURIComponent(m)+'"';h+=', "hashInfo" :'+j;h+=', "mailConfigName" : "'+encodeURIComponent(k)+'"';h+=', "mailSubject" : "'+encodeURIComponent(i)+'"';h+=', "mailTemplate" : "'+encodeURIComponent(g)+'"';h+=', "replaceList" : '+l;h+="}";var d={id:++nextRequestId,method:"AddHash",params:h};asyncJsonRequest(jsonHashHandler,d,c,function(o){var q=false;if(o.hasOwnProperty("Result")===true){var n=o.Result;if(n.hasOwnProperty("message")===true){if(typeof(b)==="function"){b()}}else{if(n.hasOwnProperty("error")===true){var p="Unable to Register ["+n.error+"]";showError(p,c);console.log(p)}}}else{if(o.hasOwnProperty("Error")===true){var p=o.Error;console.log(p)}}})}}function hashConfirm(e,f,i,l,j,g,m,c,b){var a=true;var k="{";k+='"purchaserCode" : "'+f+'"';k+=', "accessPassword" : "'+i+'"';k+="}";if(a==true){var h="{";h+='"hashType" : "PurchaserConfirm"';h+=', "hash" : "'+encodeURIComponent(e)+'"';h+=', "hashInfo" :'+k;h+=', "mailConfigName" : "'+encodeURIComponent(l)+'"';h+=', "mailSubject" : "'+encodeURIComponent(j)+'"';h+=', "mailTemplate" : "'+encodeURIComponent(g)+'"';h+=', "replaceList" : '+m;h+="}";var d={id:++nextRequestId,method:"ConfirmHash",params:h};asyncJsonRequest(jsonHashHandler,d,c,function(o){var q=false;if(o.hasOwnProperty("Result")===true){var n=o.Result;if(n.hasOwnProperty("message")===true){if(typeof(b)==="function"){b()}}else{if(n.hasOwnProperty("error")===true){var p="Unable to Confirm Registration. Enter Correct Purchaser Code and Access Password or Please Re Register";showError(p,c);console.log(p)}}}else{if(o.hasOwnProperty("Error")===true){var p=o.Error;console.log(p)}}})}};